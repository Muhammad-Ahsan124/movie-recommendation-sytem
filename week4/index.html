<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Two-Tower + Deep (MLP) — MovieLens 100K (TF.js)</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.19.0/dist/tf.min.js"></script>
  <script defer src="two-tower.js"></script>
  <script defer src="app.js"></script>
  <style>
    body {font-family:Segoe UI, sans-serif; margin:15px;}
    .box {border:1px solid #ccc; border-radius:8px; padding:12px; margin:6px 0;}
  </style>
</head>
<body>
  <h3>Two-Tower + Deep (MLP) Retrieval — MovieLens 100K (TF.js)</h3>

  <div class="box">
    <button id="loadBtn">Load Data</button>
    <button id="trainBtn">Train</button>
    <button id="testBtn">Test</button>
    &nbsp;
    embeddingDim <input id="embDim" type="number" value="32" size="3">
    epochs <input id="epochs" type="number" value="5" size="3">
    batch <input id="batch" type="number" value="128" size="3">
    maxInteractions <input id="maxInt" type="number" value="80000" size="6">
    <span id="errorMsg" style="color:red; margin-left:10px;"></span>
    <p>Tips: Put <u>u.data</u> and <u>u.item</u> in <code>/data</code> or upload manually.</p>
    <p>
      Choose u.data <input type="file" id="dataFile"> 
      Choose u.item (optional) <input type="file" id="itemFile">
    </p>
  </div>

  <div class="box">
    <strong>Model Options</strong><br>
    <label><input type="checkbox" id="useBPR"> Use BPR-style loss</label><br>
    <label><input type="checkbox" id="useGenres" checked> Use genres as item features for Deep model</label><br>
    <label><input type="checkbox" id="useSynth" checked> Use synthesized user features for Deep model</label><br>
    <label><input type="checkbox" id="useMLP" checked> Train Deep (MLP) model in addition to Two-Tower</label>
  </div>

  <div class="box">
    <strong>Training / Loss</strong><br>
    <canvas id="lossChart" width="400" height="200"></canvas>
  </div>

  <div class="box">
    <strong>Results — Test (Side-by-side)</strong>
    <div id="results"></div>
  </div>

  <div class="box">
    <strong>Embedding Projection (sampled items)</strong>
    <canvas id="projCanvas" width="400" height="300"></canvas>
  </div>
</body>
</html>
